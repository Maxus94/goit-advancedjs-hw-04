{"version":3,"file":"commonHelpers.js","sources":["../src/index.js"],"sourcesContent":["import axios from 'axios';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst form = document.querySelector('.search-form');\nconst input = document.querySelector('input[name=\"searchQuery\"]');\nconst gallery = document.querySelector('.gallery');\nconst loadMoreButton = document.querySelector('.load-more');\n\nlet page = 1;\nlet textToSearch = '';\nlet gallerySimpleLightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 50,\n});\n\nform.addEventListener('submit', searchButtonHandler);\nloadMoreButton.addEventListener('click', loadMoreHandler);\n\nasync function loadMoreHandler() {\n  page += 1;\n  iziToast.destroy();\n  try {\n    const data = await servicePictures(page);\n    if ((page + 1) * 40 >= data.data.totalHits) {\n      loadMoreButton.classList.add('hidden');\n      iziToast.show({\n        //title: 'Error',\n        message: `End of the collection of \"${textToSearch}\" exceeded.`,\n        close: false,\n        backgroundColor: 'red',\n        messageColor: 'white',\n        messageSize: 20,\n        timeout: 2000,\n        position: 'topRight', // bottomRight, bottomLeft, topRight, topLeft, topCenter, bottomCenter, center\n      });\n    }\n    gallery.insertAdjacentHTML('beforeend', createMarkup(data.data.hits));\n    gallerySimpleLightbox.refresh();\n  } catch {\n    iziToast.show({\n      title: 'Error',\n      message: `Something goes wrong, please try reload page.`,\n      close: false,\n      backgroundColor: 'red',\n      messageColor: 'white',\n      messageSize: 20,\n      timeout: 0,\n      position: 'topRight', // bottomRight, bottomLeft, topRight, topLeft, topCenter, bottomCenter, center\n    });\n  }\n}\n\nasync function searchButtonHandler(event) {\n  page = 1;\n  textToSearch = input.value.trim();  \n  iziToast.destroy();\n  if (textToSearch === '') {        \n    alert(\"Search form can't be empty, enter there some text for images search.\");    \n    return;\n  } else {    \n    event.preventDefault();    \n    gallery.innerHTML = '';\n    loadMoreButton.classList.add('hidden');\n    try {\n      const data = await servicePictures();\n      if (Array.from(data.data.hits).length === 0) {\n        iziToast.show({\n          title: 'Error',\n          message: `Sorry, there are no images matching your search query. Please try again.`,\n          close: false,\n          backgroundColor: 'red',\n          messageColor: 'white',\n          messageSize: 20,\n          timeout: 2000,\n          position: 'topRight', // bottomRight, bottomLeft, topRight, topLeft, topCenter, bottomCenter, center\n        });\n      } else if (Array.from(data.data.hits).length < 40) {\n        gallery.insertAdjacentHTML('beforeend', createMarkup(data.data.hits));\n        gallerySimpleLightbox.refresh();\n        iziToast.show({\n          //title: 'Error',\n          message: `Hooray! We found ${data.data.totalHits} images.`,\n          close: false,\n          backgroundColor: 'green',\n          messageColor: 'white',\n          messageSize: 20,\n          timeout: 2000,\n          position: 'topCenter', // bottomRight, bottomLeft, topRight, topLeft, topCenter, bottomCenter, center\n        });\n      } else {\n        loadMoreButton.classList.remove('hidden');\n        gallery.insertAdjacentHTML('beforeend', createMarkup(data.data.hits));\n        gallerySimpleLightbox.refresh();\n        iziToast.show({\n          //title: 'Error',\n          message: `Hooray! We found ${data.data.totalHits} images.`,\n          close: false,\n          backgroundColor: 'green',\n          messageColor: 'white',\n          messageSize: 20,\n          timeout: 2000,\n          position: 'topCenter', // bottomRight, bottomLeft, topRight, topLeft, topCenter, bottomCenter, center\n        });\n      }\n    } catch {\n      iziToast.show({\n        //title: 'Error',\n        message: `Something goes wrong, please try reload page.`,\n        close: false,\n        backgroundColor: 'red',\n        messageColor: 'white',\n        messageSize: 20,\n        timeout: 0,\n        position: 'topCenter', // bottomRight, bottomLeft, topRight, topLeft, topCenter, bottomCenter, center\n      });\n    }\n  }\n}\n\nasync function servicePictures(page = 1) {\n  const optionsAxios = {\n    params: {\n      key: '40858721-2ab2962236a746e97c71283b6',\n      q: textToSearch,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page,\n      per_page: 40,\n    },\n  };  \n  const pictures = await axios.get('https://pixabay.com/api/', optionsAxios);\n  return pictures;\n}\n\nfunction createMarkup(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n        largeImageURL,\n      }) =>\n        `<div class=\"photo-card\">\n        <a class=\"gallery__link\" href=\"${largeImageURL}\">\n      <img class=\"item-image\" src=\"${webformatURL}\" alt=\"${tags}\" width=\"400\" height=\"240\" loading=\"lazy\" />\n      </a>\n      <div class=\"info\"><p class=\"info-item\"><b>Likes</b><br>${likes}</p>\n      <p class=\"info-item\"><b>Views</b><br>${views}</p>\n      <p class=\"info-item\"><b>Comments</b><br>${comments}</p>\n      <p class=\"info-item\"><b>Downloads</b><br>${downloads}</p></div></div>`\n    )\n    .join('');\n}\n\n// function searchButtonHandler(event) {\n//   event.preventDefault();\n//   iziToast.destroy();\n//   servicePictures().then(data => {\n//     console.log(Array.from(data.data.hits).length);\n//     if (Array.from(data.data.hits).length === 0) {\n//       gallery.innerHTML='';\n//       iziToast.show({\n//         //title: 'Error',\n//         message: `Sorry, there are no images matching your search query. Please try again.`,\n//         close: false,\n//         backgroundColor: 'red',\n//         messageColor: 'white',\n//         messageSize: 20,\n//         timeout: 0,\n//         position: 'topRight', // bottomRight, bottomLeft, topRight, topLeft, topCenter, bottomCenter, center\n//       });\n//     } else {\n//       loadMoreButton.classList.remove('hidden');\n//       gallery.insertAdjacentHTML('beforeend', createMarkup(data.data.hits));\n//       gallerySimpleLightbox.refresh();\n//       console.log(gallerySimpleLightbox);\n//     }\n//   });\n// }\n\n// function loadMoreHandler() {\n//   page += 1;\n//   servicePictures(page).then(data => {\n//     console.log(page * 40, data.data.totalHits);\n//     if ((page + 1) * 40 >= data.data.totalHits) {\n//       loadMoreButton.classList.add('hidden');\n//     }\n//     gallery.insertAdjacentHTML('beforeend', createMarkup(data.data.hits));\n//     gallerySimpleLightbox.refresh();\n//     console.log(gallerySimpleLightbox);\n//   });\n// }\n"],"names":["form","input","gallery","loadMoreButton","page","textToSearch","gallerySimpleLightbox","SimpleLightbox","searchButtonHandler","loadMoreHandler","iziToast","data","servicePictures","createMarkup","event","optionsAxios","axios","arr","webformatURL","tags","likes","views","comments","downloads","largeImageURL"],"mappings":"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"}